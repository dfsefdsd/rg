<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" 
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">


<!-- 不使用namespace是由于sql搜索定位会比较方便 -->
<sqlMap>

    <resultMap id="RM.Im$inquiries" class="com.company.project.model.Im$inquiries">
        <result property="inquiryId" column="INQUIRY_ID"/>
        <result property="contentId" column="CONTENT_ID"/>
        <result property="extBuyerId" column="EXT_BUYER_ID"/>
        <result property="extContactId" column="EXT_CONTACT_ID"/>
        <result property="compId" column="COMP_ID"/>
        <result property="contactId" column="CONTACT_ID"/>
        <result property="orgType" column="ORG_TYPE"/>
        <result property="inquiryType" column="INQUIRY_TYPE"/>
        <result property="inquiryTime" column="INQUIRY_TIME"/>
        <result property="lastThreadTime" column="LAST_THREAD_TIME"/>
        <result property="recipientTotal" column="RECIPIENT_TOTAL"/>
        <result property="deleted" column="DELETED"/>
        <result property="deadline" column="DEADLINE"/>
        <result property="cc" column="CC"/>
        <result property="sendCopy" column="SEND_COPY"/>
        <result property="expectQtyVol" column="EXPECT_QTY_VOL"/>
        <result property="requests" column="REQUESTS"/>
        <result property="createBy" column="CREATE_BY"/>
        <result property="createTime" column="CREATE_TIME"/>
        <result property="lastUpdateBy" column="LAST_UPDATE_BY"/>
        <result property="lastUpdateTime" column="LAST_UPDATE_TIME"/>
        <result property="isHeld" column="IS_HELD"/>
    </resultMap>

	<!-- 用于select查询公用抽取的列 -->
	<sql id="Im$inquiries.columns">
	    <![CDATA[
        INQUIRY_ID ,CONTENT_ID ,EXT_BUYER_ID ,EXT_CONTACT_ID ,COMP_ID ,CONTACT_ID ,ORG_TYPE ,INQUIRY_TYPE ,INQUIRY_TIME ,LAST_THREAD_TIME ,RECIPIENT_TOTAL ,DELETED ,DEADLINE ,CC ,SEND_COPY ,EXPECT_QTY_VOL ,REQUESTS ,CREATE_BY ,CREATE_TIME ,LAST_UPDATE_BY ,LAST_UPDATE_TIME ,IS_HELD 
	    ]]>
	</sql>
	
    <insert id="Im$inquiries.insert" >
    <![CDATA[
        INSERT INTO IM$INQUIRIES (
        	INQUIRY_ID ,
        	CONTENT_ID ,
        	EXT_BUYER_ID ,
        	EXT_CONTACT_ID ,
        	COMP_ID ,
        	CONTACT_ID ,
        	ORG_TYPE ,
        	INQUIRY_TYPE ,
        	INQUIRY_TIME ,
        	LAST_THREAD_TIME ,
        	RECIPIENT_TOTAL ,
        	DELETED ,
        	DEADLINE ,
        	CC ,
        	SEND_COPY ,
        	EXPECT_QTY_VOL ,
        	REQUESTS ,
        	CREATE_BY ,
        	CREATE_TIME ,
        	LAST_UPDATE_BY ,
        	LAST_UPDATE_TIME ,
        	IS_HELD 
        ) VALUES (
        	#inquiryId# ,
        	#contentId# ,
        	#extBuyerId# ,
        	#extContactId# ,
        	#compId# ,
        	#contactId# ,
        	#orgType# ,
        	#inquiryType# ,
        	#inquiryTime# ,
        	#lastThreadTime# ,
        	#recipientTotal# ,
        	#deleted# ,
        	#deadline# ,
        	#cc# ,
        	#sendCopy# ,
        	#expectQtyVol# ,
        	#requests# ,
        	#createBy# ,
        	#createTime# ,
        	#lastUpdateBy# ,
        	#lastUpdateTime# ,
        	#isHeld# 
        )
    ]]>
    <!--
    mysql:		type="post" SELECT  select last_insert_id()
    sqlserver:	type="post" SELECT  @@identity  AS  ID
    oracle:		type="pre" 	SELECT  sequenceName.nextval AS ID FROM DUAL
    DB2:		type="pre"	values nextval for sequenceName
    -->
        <selectKey resultClass="java.lang.Long" type="post" keyProperty="inquiryId" >
            select last_insert_id()
        </selectKey>
    </insert>

    <update id="Im$inquiries.update" >
    <![CDATA[
        UPDATE IM$INQUIRIES SET
	        CONTENT_ID = #contentId# ,
	        EXT_BUYER_ID = #extBuyerId# ,
	        EXT_CONTACT_ID = #extContactId# ,
	        COMP_ID = #compId# ,
	        CONTACT_ID = #contactId# ,
	        ORG_TYPE = #orgType# ,
	        INQUIRY_TYPE = #inquiryType# ,
	        INQUIRY_TIME = #inquiryTime# ,
	        LAST_THREAD_TIME = #lastThreadTime# ,
	        RECIPIENT_TOTAL = #recipientTotal# ,
	        DELETED = #deleted# ,
	        DEADLINE = #deadline# ,
	        CC = #cc# ,
	        SEND_COPY = #sendCopy# ,
	        EXPECT_QTY_VOL = #expectQtyVol# ,
	        REQUESTS = #requests# ,
	        CREATE_BY = #createBy# ,
	        CREATE_TIME = #createTime# ,
	        LAST_UPDATE_BY = #lastUpdateBy# ,
	        LAST_UPDATE_TIME = #lastUpdateTime# ,
	        IS_HELD = #isHeld# 
        WHERE 
	        INQUIRY_ID = #inquiryId# 
    ]]>
    </update>

    <delete id="Im$inquiries.delete">
    <![CDATA[
        DELETE FROM IM$INQUIRIES WHERE
        INQUIRY_ID = #inquiryId# 
    ]]>
    </delete>
    
    <select id="Im$inquiries.getById" resultMap="RM.Im$inquiries">
	    SELECT <include refid="Im$inquiries.columns"/>
	    <![CDATA[
	        FROM IM$INQUIRIES 
	        WHERE 
		        INQUIRY_ID = #inquiryId# 
	    ]]>
    </select>

	<sql id="Im$inquiries.findPage.where">
	    <dynamic prepend="WHERE">
		       <isNotEmpty prepend="AND" property="inquiryId">
		             INQUIRY_ID = #inquiryId#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="contentId">
		             CONTENT_ID = #contentId#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="extBuyerId">
		             EXT_BUYER_ID = #extBuyerId#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="extContactId">
		             EXT_CONTACT_ID = #extContactId#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="compId">
		             COMP_ID = #compId#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="contactId">
		             CONTACT_ID = #contactId#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="orgType">
		             ORG_TYPE = #orgType#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="inquiryType">
		             INQUIRY_TYPE = #inquiryType#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="inquiryTimeBegin">
		             INQUIRY_TIME >= #inquiryTimeBegin#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="inquiryTimeEnd">
		             INQUIRY_TIME &lt;= #inquiryTimeEnd#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="lastThreadTimeBegin">
		             LAST_THREAD_TIME >= #lastThreadTimeBegin#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="lastThreadTimeEnd">
		             LAST_THREAD_TIME &lt;= #lastThreadTimeEnd#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="recipientTotal">
		             RECIPIENT_TOTAL = #recipientTotal#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="deleted">
		             DELETED = #deleted#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="deadline">
		             DEADLINE = #deadline#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="cc">
		             CC = #cc#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="sendCopy">
		             SEND_COPY = #sendCopy#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="expectQtyVol">
		             EXPECT_QTY_VOL = #expectQtyVol#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="requests">
		             REQUESTS = #requests#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="createBy">
		             CREATE_BY = #createBy#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="createTimeBegin">
		             CREATE_TIME >= #createTimeBegin#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="createTimeEnd">
		             CREATE_TIME &lt;= #createTimeEnd#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="lastUpdateBy">
		             LAST_UPDATE_BY = #lastUpdateBy#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="lastUpdateTimeBegin">
		             LAST_UPDATE_TIME >= #lastUpdateTimeBegin#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="lastUpdateTimeEnd">
		             LAST_UPDATE_TIME &lt;= #lastUpdateTimeEnd#
		       </isNotEmpty>
		       <isNotEmpty prepend="AND" property="isHeld">
		             IS_HELD = #isHeld#
		       </isNotEmpty>
	    </dynamic>	
	</sql>
	 
    <select id="Im$inquiries.findPage.count" resultClass="long">
        SELECT count(*) FROM IM$INQUIRIES <include refid="Im$inquiries.findPage.where"/>    
    </select>
    
    <!--
    	分页查询已经使用Dialect进行分页,也可以不使用Dialect直接编写分页
    	因为分页查询将传 #offset#,#pageSize#,#lastRows# 三个参数,不同的数据库可以根于此三个参数属性应用不同的分页实现
    -->
    <select id="Im$inquiries.findPage" resultMap="RM.Im$inquiries">
    	SELECT <include refid="Im$inquiries.columns"/> FROM IM$INQUIRIES 
		<include refid="Im$inquiries.findPage.where"/>
		<dynamic prepend="ORDER BY">
			<isNotEmpty property="sortColumns">$sortColumns$</isNotEmpty>
		</dynamic>
    </select>

	
</sqlMap>

